# language: zh-TW
功能: 多語言排版設計系統
  作為 部落格讀者
  我想要 在三種語言(繁中、英文、日文)下都有優秀的閱讀體驗
  以便 舒適地閱讀長文內容,不會因為排版問題造成閱讀疲勞

  背景:
    假設 專案已完成多語言排版系統實作
    並且 開發伺服器正在運行 http://localhost:3000

  場景: 繁體中文文章排版正確
    假設 我開啟繁體中文文章頁面 "/zh/posts/2024-01-01_test-post"
    當 我檢視文章內容的排版
    那麼 正文字體應為 Noto Sans TC
    並且 正文字體大小應約為 18px
    並且 正文行距應為 200% 左右
    並且 文章標題應使用 Noto Serif TC 字體
    並且 標題字體應比正文粗(字重 600-700)
    並且 署名區塊應使用 Noto Serif TC 字體
    並且 DOM 中應有 lang="zh-Hant-TW" 屬性

  場景: 日文文章排版正確
    假設 我開啟日文文章頁面 "/ja/posts/2024-01-01_test-post"
    當 我檢視文章內容的排版
    那麼 正文字體應為 Noto Sans JP
    並且 正文字體大小應約為 16px
    並且 正文行距應為 185% 左右
    並且 文章標題應使用 Noto Serif JP 字體
    並且 DOM 中應有 lang="ja" 屬性
    並且 應套用 font-feature-settings palt 特性

  場景: 英文文章排版正確
    假設 我開啟英文文章頁面 "/en/posts/2024-01-01_test-post"
    當 我檢視文章內容的排版
    那麼 正文字體應為 Noto Sans
    並且 正文字體大小應約為 16px
    並且 正文行距應為 175% 左右
    並且 文章標題應使用 Noto Serif 字體
    並且 DOM 中應有 lang="en" 屬性

  場景: 切換語言後排版自動調整
    假設 我開啟繁體中文文章頁面 "/zh/posts/2024-01-01_test-post"
    並且 我記錄當前的字體大小和行距
    當 我切換到英文版本 "/en/posts/2024-01-01_test-post"
    那麼 字體大小應該變小(從 18px 變為 16px)
    並且 行距應該變小(從 200% 變為 175%)
    並且 字體家族應該改變(從 TC 變為英文版本)
    並且 lang 屬性應該改變(從 zh-Hant-TW 變為 en)

  場景: 深色模式下排版正確顯示
    假設 我開啟繁體中文文章頁面 "/zh/posts/2024-01-01_test-post"
    當 我切換到深色模式
    那麼 文章標題應清晰可讀
    並且 正文內容應清晰可讀
    並且 署名區塊應清晰可讀
    並且 連結顏色應有足夠對比度
    並且 引用區塊的邊框應可見
    並且 所有排版參數(字體大小、行距、字距)應保持不變

  場景: 程式碼區塊使用等寬字體
    假設 我開啟包含程式碼的文章頁面
    當 我檢視程式碼區塊
    那麼 程式碼應使用 Noto Sans Mono 字體
    並且 程式碼應有語法高亮
    並且 程式碼不應套用 palt 字型特性
    並且 程式碼字體大小應約為 14px (0.875em)

  場景: 標題層級視覺區隔明顯
    假設 我開啟包含多層級標題的文章頁面
    當 我檢視文章的標題層級
    那麼 H1 標題應最大且最粗
    並且 H2 標題應比 H1 小但比 H3 大
    並且 H3 標題應比 H2 小但比 H4 大
    並且 H4 標題應比 H3 小
    並且 所有標題都應使用襯線字體
    並且 標題與正文應有明顯的視覺對比

  場景: 署名區塊樣式正確
    假設 我開啟任一文章頁面
    當 我滾動到文章底部
    那麼 署名區塊應使用襯線字體
    並且 署名字體大小應較小(text-sm)
    並且 署名顏色應使用 muted-foreground
    並且 署名應靠右對齊
    並且 署名應有適當的上方間距(mt-8)

  場景: 響應式排版在不同螢幕尺寸下正常
    假設 我開啟文章頁面
    當 我調整瀏覽器寬度到手機尺寸(375px)
    那麼 文章內容應使用 prose class 的預設大小
    並且 文章應保持可讀性
    當 我調整瀏覽器寬度到桌面尺寸(1280px)
    那麼 文章內容應使用 prose-lg 的較大尺寸
    並且 行長應控制在合理範圍(約 65ch)

  場景: 字型正確載入
    假設 我開啟任一文章頁面
    當 我使用開發者工具檢查 Network 標籤
    那麼 應該看到 Noto Sans 字型從 Google Fonts 載入
    並且 應該看到 Noto Serif 字型從 Google Fonts 載入
    並且 應該看到 Noto Sans Mono 字型從 Google Fonts 載入
    並且 字型應使用 font-display: swap
    並且 不應有字型載入錯誤

  場景: CSS 檔案大小合理
    假設 我執行 npm run build
    當 我檢查生成的 CSS 檔案
    那麼 最終 CSS 檔案 gzipped 後應小於 50KB
    並且 應包含 prose 相關樣式
    並且 應包含語言特定的樣式(zh:, ja:, en:)

  場景: 靜態生成成功
    假設 我執行 npm run build
    當 建置完成
    那麼 應無 TypeScript 錯誤
    並且 應無 Tailwind 配置錯誤
    並且 應生成所有語言版本的靜態 HTML
    並且 靜態 HTML 中應包含正確的 lang 屬性

  場景大綱: 不同語言的排版參數正確
    假設 我開啟 "<locale>" 語言的文章頁面
    當 我使用開發者工具檢視計算後的樣式
    那麼 字體大小應為 "<fontSize>"
    並且 行距應為 "<lineHeight>"
    並且 字距應為 "<letterSpacing>"
    並且 lang 屬性應為 "<langAttr>"

    例子:
      | locale | fontSize | lineHeight | letterSpacing | langAttr     |
      | zh     | 18px     | 2          | 0.05em        | zh-Hant-TW   |
      | ja     | 16px     | 1.85       | 0.02em        | ja           |
      | en     | 16px     | 1.75       | 0.01em        | en           |

  場景: Tailwind localized 變體正常運作
    假設 我檢視繁體中文頁面的 DOM
    當 我查看具有 zh:text-lg 等 class 的元素
    那麼 這些元素應套用對應的樣式
    並且 只有在 lang="zh-Hant-TW" 的父元素內才生效
    當 我切換到英文頁面
    那麼 zh:text-lg 的樣式應不再生效
    並且 en:text-base 等樣式應開始生效

  場景: 深色模式 prose-invert 正常運作
    假設 我開啟文章頁面並切換到深色模式
    當 我檢視 prose 元素的樣式
    那麼 應套用 dark:prose-invert 樣式
    並且 文字顏色應自動反轉為淺色
    並且 連結顏色應適應深色背景
    並且 引用邊框顏色應適應深色背景

# language: zh-TW
功能: 部落格多語言支援
  作為部落格讀者
  我想要能夠切換不同語言查看內容
  以便用我熟悉的語言閱讀文章

  背景:
    假設部落格已完成多語言功能實作
    並且已執行建置產生靜態網站
    並且已啟動本地開發伺服器或靜態伺服器

  場景: 根路徑自動重新導向到繁體中文版
    當我訪問根路徑 "/"
    那麼應該自動重新導向到 "/zh/"
    並且頁面應該正常顯示

  場景: 日文讀者切換到日文版並查看文章列表
    假設有 100 篇中文文章
    並且有 3 篇文章有日文翻譯
    當我訪問 "/ja/"
    並且點擊導航列的「すべての記事」連結
    那麼應該導向到 "/ja/posts"
    並且文章列表應該只顯示 3 篇文章
    並且列表下方應該顯示提示訊息包含「繁體中文」和文章數量

  場景: 英文讀者切換到英文版並查看技術分類
    假設有 50 篇中文技術文章
    並且有 1 篇技術文章有英文翻譯
    當我訪問 "/en/tech"
    那麼頁面標題應該顯示 "Tech"
    並且文章列表應該只顯示 1 篇文章
    並且列表下方應該顯示提示訊息

  場景: 語言切換器在所有頁面正常運作
    當我訪問 "/zh/"
    那麼導航列應該顯示語言切換器包含「中文」「日本語」「English」
    並且「中文」應該以粗體顯示
    當我點擊「日本語」
    那麼應該導向到 "/ja/"
    並且「日本語」應該以粗體顯示

  場景: 語言切換保持當前頁面上下文
    當我訪問 "/zh/tech"
    並且點擊「English」
    那麼應該導向到 "/en/tech"
    並且頁面應該正常顯示

  場景: 文章頁面顯示其他可用語言版本
    假設文章「2024-01-01_test」有繁體中文、日文、英文三個版本
    當我訪問 "/zh/posts/2024-01-01_test"
    那麼文章標題下方應該顯示「Also available in: 日本語 English」
    並且「日本語」連結應該指向 "/ja/posts/2024-01-01_test"
    並且「English」連結應該指向 "/en/posts/2024-01-01_test"
    當我訪問 "/ja/posts/2024-01-01_test"
    那麼文章標題下方應該顯示「Also available in: 繁體中文 English」

  場景: 文章頁面不顯示當前語言為可切換選項
    假設文章「2024-01-01_test」只有繁體中文和日文版本
    當我訪問 "/zh/posts/2024-01-01_test"
    那麼文章標題下方應該只顯示「Also available in: 日本語」
    並且不應該顯示「繁體中文」連結

  場景: 沒有其他語言版本的文章不顯示語言指示器
    假設文章「2024-02-01_chinese-only」只有繁體中文版本
    當我訪問 "/zh/posts/2024-02-01_chinese-only"
    那麼文章標題下方不應該顯示「Also available in」區塊

  場景: 所有 UI 元素正確翻譯為日文
    當我訪問 "/ja/"
    那麼導航列的「首頁」應該顯示為「ホーム」
    並且「關於」應該顯示為「概要」
    並且「訂閱」應該顯示為「購読」
    並且「全部文章」應該顯示為「すべての記事」

  場景: 所有 UI 元素正確翻譯為英文
    當我訪問 "/en/"
    那麼導航列的「首頁」應該顯示為「Home」
    並且「關於」應該顯示為「About」
    並且「訂閱」應該顯示為「Subscribe」
    並且「全部文章」應該顯示為「All Posts」

  場景: 日期格式根據語言正確顯示
    假設文章日期為「2024-01-15」
    當我訪問繁體中文版的文章
    那麼日期應該顯示為「2024 年 1 月 15 日」格式
    當我訪問日文版的文章
    那麼日期應該顯示為「2024年1月15日」格式
    當我訪問英文版的文章
    那麼日期應該顯示為「January 15, 2024」格式

  場景: RSS feed 正確過濾語言和分類
    當我訪問 "/rss/ja/tech.xml"
    那麼 RSS feed 應該存在
    並且 feed 中所有文章都應該是日文技術文章
    當我訪問 "/rss/en.xml"
    那麼 RSS feed 應該存在
    並且 feed 中所有文章都應該是英文文章

  場景: 繁體中文版保留原有 RSS feed
    當我訪問 "/rss.xml"
    那麼 RSS feed 應該存在
    並且應該包含所有語言的文章

  場景: HTML 包含正確的 hreflang 標籤
    當我訪問 "/zh/"
    那麼 HTML 應該包含 hreflang 標籤
      | hreflang  | href                         |
      | zh-Hant   | https://yurenju.blog/zh/     |
      | ja        | https://yurenju.blog/ja/     |
      | en        | https://yurenju.blog/en/     |
      | x-default | https://yurenju.blog/zh/     |

  場景: 文章頁面根據可用翻譯動態產生 hreflang
    假設文章「2024-01-01_test」有繁體中文和日文版本
    當我訪問 "/zh/posts/2024-01-01_test"
    那麼 HTML 應該包含 hreflang 標籤
      | hreflang  | href                                         |
      | zh-Hant   | https://yurenju.blog/zh/posts/2024-01-01_test |
      | ja        | https://yurenju.blog/ja/posts/2024-01-01_test |
      | x-default | https://yurenju.blog/zh/posts/2024-01-01_test |
    並且不應該包含 "en" 的 hreflang 標籤

  場景: HTML lang 屬性根據語言正確設定
    當我訪問 "/zh/"
    那麼 HTML lang 屬性應該是 "zh-Hant-TW"
    當我訪問 "/ja/"
    那麼 HTML lang 屬性應該是 "ja"
    當我訪問 "/en/"
    那麼 HTML lang 屬性應該是 "en"

  場景: 建置效能符合目標
    假設記錄了實作前的建置時間為基準
    當執行完整建置
    那麼建置時間應該不超過基準時間的 150%
    並且應該成功產生所有語言版本的靜態頁面

  場景: Bundle size 符合目標
    假設記錄了實作前的 bundle size 為基準
    當執行完整建置
    那麼 JavaScript bundle size 增加應該少於 10KB

  場景: 作者新增文章翻譯
    假設文章目錄「2024-03-01_new-post」包含「index.md」
    當作者在該目錄建立「index.ja.md」檔案並加入日文翻譯內容
    並且執行建置
    那麼 "/ja/posts" 應該顯示這篇新文章
    並且 "/zh/posts/2024-03-01_new-post" 應該在標題下方顯示「Also available in: 日本語」
    並且 "/ja/posts/2024-03-01_new-post" 應該正確顯示日文內容
    並且文章的標題、日期、分類應該與繁體中文版相同

  場景: 分類頁面語言過濾正確運作
    假設有 30 篇中文生活文章
    並且有 2 篇生活文章有英文翻譯
    當我訪問 "/en/life"
    那麼頁面標題應該顯示 "Life"
    並且應該只顯示 2 篇文章
    並且列表下方應該顯示提示訊息包含中文版文章數量

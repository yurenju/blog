# PRD: Claude Code Slash Command `/translate`

## 簡介/概述

建立一個新的 Claude Code slash command `/translate`，用於將部落格的中文 markdown 文章翻譯成日文和英文。這個功能將簡化目前手動翻譯的流程，確保翻譯品質符合不同文章分類的需求，並自動產生符合專案檔案結構的翻譯檔案。

## 目標

1. 提供一個簡單的指令介面，讓使用者可以快速翻譯部落格文章
2. 根據文章分類（tech/life）採用不同的翻譯策略，確保翻譯品質
3. 自動產生符合專案結構的翻譯檔案（日文 `index.ja.md`、英文 `index.en.md`）
4. 提供中文回譯功能，方便使用者驗證翻譯品質
5. 正確處理 markdown 格式、程式碼、圖片和連結

## 使用者故事

1. 作為一個部落格作者，我想要快速將中文文章翻譯成日文和英文，以便觸及更多讀者
2. 作為一個部落格作者，我想要不同分類的文章使用不同的翻譯風格，以便保持文章的原始意圖和感受
3. 作為一個不懂日文的作者，我想要看到翻譯後的中文回譯，以便確認翻譯是否符合我的預期
4. 作為一個部落格作者，我想要翻譯後的檔案自動儲存在正確的位置，以便我可以直接使用而不需要手動移動檔案

## 功能需求

### 1. 指令介面
1.1. 指令名稱為 `/translate`，接受一個參數：中文 markdown 檔案的路徑
1.2. 指令格式：`/translate <file_path>`
1.3. 範例：`/translate public/posts/2025-04-23_ai-coding-doesnt-understand-me/叫 AI 幫我寫程式，結果他聽不懂人話？.md`

### 2. 文章分類判斷
2.1. 從 frontmatter 中讀取 `categories` 欄位判斷文章分類
2.2. 如果找不到分類資訊，根據文章內容自行判斷是 tech 或 life 分類
2.3. 支援的分類：tech（科技）、life（生活/抒情）

### 3. 翻譯策略

#### 3.1. Tech 分類翻譯
- 採用理性、專業的口吻
- 精準翻譯技術術語和概念
- 考慮目標語言讀者的閱讀習慣和背景知識
- 保持技術文章的清晰度和準確性

#### 3.2. Life 分類翻譯
- 採用抒情、表達性的口吻
- 不需要逐字翻譯，而是根據目標語言的語境進行調整
- 注重閱讀節奏和情感傳達
- 可以適度改寫以符合目標語言的表達習慣

### 4. Frontmatter 處理
4.1. 只包含 `title` 欄位在翻譯後的檔案中
4.2. 如果原文 frontmatter 有 `title` 欄位，將其翻譯成目標語言
4.3. 如果原文 frontmatter 沒有 `title` 欄位，使用原文檔名（不含副檔名）作為標題來源進行翻譯
4.4. 其他 frontmatter 欄位（如 slug, categories）不複製到翻譯檔案

**範例**：
- 原文檔名：`叫 AI 幫我寫程式，結果他聽不懂人話？.md`（無 title 欄位）
- 日文 frontmatter：`title: AIにコードを書いてもらったら、理解してもらえない？`
- 英文 frontmatter：`title: Asked AI to Write Code, But It Can't Understand Me?`

### 5. 內容元素處理

#### 5.1. 程式碼區塊
- 程式碼中的中文註解需要翻譯成目標語言
- 程式碼本身（變數名稱、函數、語法）不翻譯
- 英文註解保持原樣，不進行翻譯

#### 5.2. 圖片連結
- 格式：`![[image.png]]` 或 `![alt text](path/to/image.png)`
- 翻譯 alt text（替代文字）
- 保持圖片路徑不變

#### 5.3. 超連結
- 格式：`[link text](url)`
- 翻譯連結文字
- 保持 URL 不變

#### 5.4. 作品名稱（書籍、動畫、漫畫等）
- 當文章中引用書籍、動畫、漫畫、電影等作品時，需要查詢該作品的官方翻譯名稱
- 使用網頁搜尋功能查找作品在目標語言市場的正式名稱
- 不要直接翻譯作品名稱，而是使用官方翻譯或通用名稱
- 如果找不到官方翻譯，可以保留原文或進行音譯

**範例**：
- 中文：「歷史之眼」（岩明均的漫畫作品）
- 日文：「ヒストリエ」(Historie)
- 英文：Historie
- ❌ 錯誤做法：直接翻譯成「歴史の目」或「Eye of History」
- ✅ 正確做法：搜尋後使用官方名稱「ヒストリエ」和「Historie」

#### 5.5. 人名和地名
- 當文章中出現人名或地名時，需要查詢該人名或地名在目標語言中的正確寫法
- 使用網頁搜尋功能確認官方或慣用的表記方式
- 人名要特別注意原始語言的拼寫和目標語言的慣用表記
- 地名要使用目標語言中的標準譯名

**人名範例**：
- 中文：浦澤直樹（漫畫家）
- 日文：浦沢直樹（うらさわ なおき）
- 英文：Naoki Urasawa
- ❌ 錯誤：直接使用中文「浦澤直樹」或錯誤的「溥澤直樹」
- ✅ 正確：日文使用「浦沢直樹」，英文使用「Naoki Urasawa」

**地名處理原則**：
- 確認目標語言中的官方或慣用譯名
- 對於知名地點，使用目標語言的標準表記
- 必要時附註原文以避免混淆

### 6. 輸出檔案

#### 6.1. 檔案位置
- 日文翻譯：儲存在與原始檔案相同目錄下，檔名為 `index.ja.md`
- 英文翻譯：儲存在與原始檔案相同目錄下，檔名為 `index.en.md`

#### 6.2. 檔案格式
```markdown
---
title: [翻譯後的標題]
---

[翻譯後的內容]

---
[中文回譯內容]
```

### 7. 中文回譯功能
7.1. 所有翻譯（tech 和 life 分類）都需要提供中文回譯
7.2. 回譯內容使用 `---` 分隔線附加在翻譯內容的最後
7.3. 回譯的目的是讓使用者理解翻譯後的內容在目標語言中的實際意思
7.4. 使用者會在審閱後手動刪除回譯部分

### 8. 同時產生兩種語言
8.1. 每次執行 `/translate` 指令時，同時產生日文和英文兩個翻譯檔案
8.2. 兩個檔案都包含各自的中文回譯

### 9. 網頁搜尋功能
9.1. 翻譯過程中需要使用網頁搜尋來查詢作品名稱的官方翻譯
9.2. 使用者不需要額外授予搜尋權限，指令應該直接可以執行搜尋
9.3. 搜尋範圍：作品的官方名稱、翻譯版本、市場通用名稱

## 非目標（超出範圍）

1. 不支援其他語言的翻譯（只支援中文→日文、中文→英文）
2. 不提供翻譯品質的自動評分或建議
3. 不處理影片或音訊內容的翻譯
4. 不自動更新部落格的導航或索引
5. 不提供翻譯記憶或術語庫功能
6. 不支援批次翻譯多個檔案

## 設計考量

### 翻譯範例參考
- 中文原文：`public/posts/2025-04-23_ai-coding-doesnt-understand-me/叫 AI 幫我寫程式，結果他聽不懂人話？.md`
- 日文翻譯：`public/posts/2025-04-23_ai-coding-doesnt-understand-me/index.ja.md`
- 英文翻譯：`public/posts/2025-04-23_ai-coding-doesnt-understand-me/index.en.md`

使用者可以參考這些範例檔案來理解翻譯的風格和品質要求。

### 檔案結構
```
public/posts/YYYY-MM-DD_slug/
├── 原始中文標題.md          # 原始中文文章
├── index.ja.md              # 日文翻譯
└── index.en.md              # 英文翻譯
```

## 技術考量

### Claude Code Slash Command 實作
1. 在 `.claude/commands/` 目錄下建立 `translate.md` 檔案
2. 檔案內容應包含完整的指令提示詞（prompt）
3. 提示詞需要包含所有翻譯規則、格式要求和範例
4. 使用 frontmatter 配置指令，確保可以使用必要的工具：
   ```yaml
   ---
   argument-hint: <file_path>
   description: Translate Chinese blog post to Japanese and English
   allowed-tools: Read, Write, WebSearch
   ---
   ```
5. `allowed-tools` 需包含：
   - `Read`: 讀取原始檔案
   - `Write`: 寫入翻譯檔案
   - `WebSearch`: 搜尋作品名稱的官方翻譯

### 檔案讀寫
1. 使用 Read 工具讀取原始中文檔案
2. 使用 Write 工具寫入翻譯後的檔案
3. 確保路徑處理正確（Windows 和 Unix 路徑相容性）

### 錯誤處理建議
1. 檔案不存在時提供清楚的錯誤訊息
2. frontmatter 格式錯誤時給予警告但繼續處理
3. 無法判斷分類時預設為 tech 並告知使用者

## 開放問題

1. 是否需要在翻譯前讓使用者確認偵測到的文章分類？
2. 如果翻譯檔案已存在，是否需要詢問使用者是否覆蓋？
3. 是否需要提供選項讓使用者只產生單一語言的翻譯？
4. 技術術語的翻譯是否需要維護一個一致性對照表？

## 參考資料

- 現有翻譯範例：`public/posts/2025-04-23_ai-coding-doesnt-understand-me/` 目錄下的檔案
- Claude Code 文件：https://docs.claude.com/en/docs/claude-code/
